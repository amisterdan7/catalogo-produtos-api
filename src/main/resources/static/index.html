<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cat√°logo de Produtos</title>
    <style>
        body { font-family: sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background-color: #f4f4f9; }
        h1 { text-align: center; color: #333; }
        

        .form-group { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-bottom: 20px;}
        input { width: 100%; padding: 10px; margin: 5px 0; box-sizing: border-box; border: 1px solid #ddd; border-radius: 4px; }
        button { width: 100%; padding: 10px; background-color: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button:hover { background-color: #218838; }

        .produto-card { background: white; border-bottom: 1px solid #eee; padding: 15px; display: flex; justify-content: space-between; align-items: center; }
        .produto-card:first-child { border-top-left-radius: 8px; border-top-right-radius: 8px; }
        .produto-card:last-child { border-bottom-left-radius: 8px; border-bottom-right-radius: 8px; border-bottom: none; }
        .produto-info h3 { margin: 0 0 5px 0; color: #007bff; }
        .price { font-weight: bold; color: #28a745; }
        .delete-btn { background-color: #dc3545; padding: 5px 10px; margin-left: 10px; width: auto; }
    </style>
</head>
<body>

    <h1>üì¶ Cat√°logo de Produtos</h1>

    <div class="form-group">
        <h3>Novo Produto</h3>
        <input type="text" id="nome" placeholder="Nome do produto">
        <input type="text" id="descricao" placeholder="Descri√ß√£o">
        <input type="number" id="preco" placeholder="Pre√ßo (ex: 99.90)">
        <button onclick="salvarProduto()">Salvar Produto</button>
    </div>

    <div id="lista-produtos">
        <p style="text-align:center">Carregando produtos...</p>
    </div>

    <script>

        const API_URL = 'https://catalogo-produtos-api.up.railway.app'; 

        // Fun√ß√£o para buscar produtos (GET)
        async function carregarProdutos() {
            const lista = document.getElementById('lista-produtos');
            lista.innerHTML = ''; // Limpa a lista

            try {
                const response = await fetch(`${API_URL}/produtos`);
                const produtos = await response.json();

                if(produtos.length === 0) {
                    lista.innerHTML = '<p style="text-align:center">Nenhum produto cadastrado.</p>';
                    return;
                }

                produtos.forEach(produto => {
                    const item = document.createElement('div');
                    item.className = 'produto-card';
                    item.innerHTML = `
                        <div class="produto-info">
                            <h3>${produto.nome}</h3>
                            <p>${produto.descricao}</p>
                            <span class="price">R$ ${produto.preco}</span>
                        </div>
                        <button class="delete-btn" onclick="deletarProduto(${produto.id})">Excluir</button>
                    `;
                    lista.appendChild(item);
                });
            } catch (error) {
                console.error('Erro:', error);
                lista.innerHTML = '<p style="color:red; text-align:center">Erro ao carregar API. Verifique o console.</p>';
            }
        }

        // Fun√ß√£o para salvar produto (POST)
        async function salvarProduto() {
            const nome = document.getElementById('nome').value;
            const descricao = document.getElementById('descricao').value;
            const preco = document.getElementById('preco').value;

            const produto = { nome, descricao, preco: parseFloat(preco) };

            try {
                const response = await fetch(`${API_URL}/produtos`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(produto)
                });

                if (response.ok) {
                    alert('Produto salvo com sucesso!');
                    // Limpa os campos
                    document.getElementById('nome').value = '';
                    document.getElementById('descricao').value = '';
                    document.getElementById('preco').value = '';
                    carregarProdutos(); // Recarrega a lista
                } else {
                    alert('Erro ao salvar (Verifique se preencheu tudo corretamente)');
                }
            } catch (error) {
                console.error('Erro:', error);
                alert('Erro ao conectar com a API');
            }
        }

        // Fun√ß√£o para deletar (DELETE)
        async function deletarProduto(id) {
            if(confirm('Tem certeza que deseja excluir?')) {
                await fetch(`${API_URL}/produtos/${id}`, { method: 'DELETE' });
                carregarProdutos();
            }
        }

        // Carrega a lista assim que a p√°gina abre
        carregarProdutos();
    </script>

</body>
</html>